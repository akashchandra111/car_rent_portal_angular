<!doctype html>
<html lang="en">
	<head>
  		<meta charset="utf-8">
  		<title id="carclear">RentOCar</title>
  		<base href="/">
  		<meta name="viewport" content="width=device-width, initial-scale=1">
  		<link rel="icon" type="image/x-icon" href="favicon.ico">

		<!-- JQuery -->
		<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
		<!-- Compiled and minified JavaScript -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
		<!-- Initializing all the materialize elements -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- Compiled and minified CSS -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
		<!-- Compiled and minified JavaScript -->


	</head>
	<body>
  		<app-root></app-root>


		<script type="text/javascript">



// function inintalizedropdown(){
// 	$(".dropdown-trigger").dropdown();
// 	console.log("QQQ");
// }



		$(document).ready(
			() => {
// $('.navbar-fixed').bind("DOMSubtreeModified",inintalizedropdown());
$("#loginbutton").on( "click", function() {
	setTimeout( function(){
$(".dropdown-trigger").dropdown();
		$('.sidenav').sidenav();

	var pathname = window.location.pathname;
console.log(pathname);
		if(pathname=="/"){

$('.modal').modal();

		$('#login').modal('open');

}
		// Do something after 1 second
	}  , 2000 );

});
$("#loginbutton2").on( "click", function() {
	setTimeout( function(){
$(".dropdown-trigger").dropdown();
		$('.sidenav').sidenav();

	var pathname = window.location.pathname;
console.log(pathname);
		if(pathname=="/"){

$('.modal').modal();
		$('#login7').modal('open');
}
		// Do something after 1 second
	}  , 2000 );

});

$("#registerclicked").on( "click", function() {
	setTimeout( function(){
$(".dropdown-trigger").dropdown();
		$('.sidenav').sidenav();

	    // Do something after 1 second
	}  , 1000 );

});

$("#carclear").click(function() {
	console.log("clear() run");
localStorage.removeItem('carid');
});
$("#clicklogoutme").click(function() {

		$('.sidenav').sidenav();
$('.modal').modal();

});

$(".insidenav").on( "click", function() {
	setTimeout( function(){
console.log("insidedav run");

					// Sidenav initialization
					$('.sidenav').sidenav();

					// Slider initialization and params setting
					$('.slider').slider({
						indicators: false,
						height: 450,
						interval: 3000
					});

					// Modal initialization
					$('.modal').modal();

					// Form initialization
					$('select').formSelect();

					//Author Dheeraj Joshi
					//User profile Drop down
					console.log("Asdsa");
					$(".dropdown-trigger").dropdown();

					//Time picker
					$('.timepicker').timepicker();

					//Date picker
					$('.datepicker').datepicker();

					// User login drop down
					// Sidenav initialization
					$('.sidenav').sidenav();

					// Slider initialization and params
					$('.slider').slider({
							indicators: false,
							height: 450,
							interval: 3000
						}
					);
				}  , 1000 );

			});



					// Modal initialization
					$('.modal').modal();

					// Form initialization
					$('select').formSelect();

					$('.modal').modal();



					//sidenav collapsible initialization

					$('#collapsibleBooking').collapsible();
					$('#collapsibleAccount').collapsible();


});


				// Sidenav initialization
				$('.sidenav').sidenav();

				// Slider initialization and params setting
				$('.slider').slider({
					indicators: false,
					height: 450,
					interval: 3000
				});

				// Modal initialization
				$('.modal').modal();

				// Form initialization
				$('select').formSelect();

				//Author Dheeraj Joshi
				//User profile Drop down
				console.log("Asdsa");
				$(".dropdown-trigger").dropdown();

				//Time picker
				$('.timepicker').timepicker();

				//Date picker
				$('.datepicker').datepicker();

				// User login drop down
				// Sidenav initialization
				$('.sidenav').sidenav();

				// Slider initialization and params
				$('.slider').slider({
						indicators: false,
						height: 450,
						interval: 3000
					}
				);


				// Modal initialization
				$('.modal').modal();

				// Form initialization
				$('select').formSelect();

				$('.modal').modal();

				$('.tooltipped').tooltip();

				$('.fixed-action-btn').floatingActionButton();
  

				//sidenav collapsible initialization

				$('#collapsibleBooking').collapsible();
				$('#collapsibleAccount').collapsible();



				$(document).ready(function(){
					$('.sidenav').sidenav();

				});

				$(document).ready(function(){
    			$('.modal').modal();
				$('.sidenav').sidenav();
  				});
				  

		$(document).ready(
			()=>	{
				// Sidenav initialization
				$('.sidenav').sidenav();
				$('.tabs').tabs();

				$('.dropdown-trigger').dropdown();
				$('.dropdown-trigger2').dropdown();
				// Slider initialization and params setting
				$('.slider').slider(
				{
					indicators: false,
					height: 450,
					interval: 3000
				}
				);

				// show add car form and hide the cards
				$(".addcard").click(function(){

					$(".addcarform").show("slow");

					$(".updatecarform").hide("slow");
					$(".deletecarform").hide("slow");
				});

				// show update car form and hide the other forms
				$(".updatecard").click(function(){

					$(".addcarform").hide("slow");
					$(".updatecarform").show("slow");
					$(".deletecarform").hide("slow");

				});
				// show delete car form and hide other forms
				$(".deletecard").click(function(){

					$(".addcarform").hide("slow");
					$(".updatecarform").hide("slow");
					$(".deletecarform").show("slow");

				});


				
				// show total car rented stats
				$(".rentedstatecard").click(function(){
					$('html, body').animate({
						scrollTop: $("#myrentedcarstatChart").offset().top
					}, 1000);
					$("#myuserstatChart").hide("slow");
$("#myrentedcarstatRentedPie").hide("slow");
					$("#myrentedcarstatChart").show("slow");
					$("#mytopcarChart").hide("slow");
$("#myrentedcarstatAvailablePie").hide("slow");
$('#piebuttonid').show('slow');
$('#piebuttontypeid').hide('slow');
$('#piebuttonid').text("PieChart");

				});
				// show top car rented stats
				$(".topcarstatcard").click(function(){
					$('html, body').animate({
						scrollTop: $("#mytopcarChart").offset().top
					}, 1000);
					$("#myuserstatChart").hide("slow");
$("#myrentedcarstatRentedPie").hide("slow");
					$("#myrentedcarstatChart").hide("slow");
					$("#mytopcarChart").show("slow");
$("#myrentedcarstatAvailablePie").hide("slow");
$('#piebuttonid').hide('slow');
$('#piebuttontypeid').hide('slow');
				});

var graphpie=true;
var pietype=false;


				$(".piebutton").click(function(){
					if(graphpie==true){
						$('html, body').animate({
							scrollTop: $("#myrentedcarstatAvailablePie").offset().top
						}, 1000);
						$("#myuserstatChart").hide("slow");

						$("#mytopcarChart").hide("slow");
						$("#myrentedcarstatChart").hide("slow");
						$("#myrentedcarstatAvailablePie").show("slow");
						$("#myrentedcarstatRentedPie").hide("slow");

						graphpie=false;
						$('#piebuttonid').text("Chart");
						$('#piebuttontypeid').show();
				}
				else{
					$('html, body').animate({
						scrollTop: $("#myrentedcarstatChart").offset().top
					}, 1000);
					$("#myuserstatChart").hide("slow");
console.log("graphpie false");
					$("#mytopcarChart").hide("slow");
					$("#myrentedcarstatChart").show("slow");
					$("#myrentedcarstatAvailablePie").hide("slow");
					$("#myrentedcarstatRentedPie").hide("slow");
					graphpie=true;
					$('#piebuttonid').text('PieChart');
					$('#piebuttontypeid').hide('slow');

				}

				});

				$(".piebuttontype").click(function(){

					if(pietype==true){
						$('html, body').animate({
							scrollTop: $("#myrentedcarstatAvailablePie").offset().top
						}, 1000);
						$("#myuserstatChart").hide("slow");

						$("#mytopcarChart").hide("slow");
						$("#myrentedcarstatChart").hide("slow");
						$("#myrentedcarstatAvailablePie").show("slow");

						$("#myrentedcarstatRentedPie").hide("slow");
						pietype=false;
						$('#piebuttontypeid').text('RentedCars');

				}
				else{
					$('html, body').animate({
						scrollTop: $("#myrentedcarstatChart").offset().top
					}, 1000);
					$("#myuserstatChart").hide("slow");
console.log("graphpie false");
					$("#mytopcarChart").hide("slow");
					$("#myrentedcarstatChart").hide("slow");
					$("#myrentedcarstatAvailablePie").hide("slow");
					pietype=true;
					$("#myrentedcarstatRentedPie").show("slow");

					$('#piebuttontypeid').text('AvailableCars');


				}

});
				// show payment issue collection
				$(".paymentissuecard").click(function(){

					$(".paymentticket").show("slow");

					$(".mechanicalticket").hide("slow");
					$(".accidentticket").hide("slow");
					$(".cancelticket").hide("slow");
				});

				// show accident issue collection
				$(".accidentissuecard").click(function(){

					$(".paymentticket").hide("slow");

					$(".cancelticket").hide("slow");
					$(".accidentticket").show("slow");
					$(".mechanicalticket").hide("slow");
				});

				// show mechanical issue collection
				$(".mechanicalissuecard").click(function(){

					$(".paymentticket").hide("slow");

					$(".accidentticket").hide("slow");

					$(".cancelticket").hide("slow");
					$(".mechanicalticket").show("slow");
				});


				// show cancellation issue collection
				$(".cancellationissuecard").click(function(){

					$(".paymentticket").hide("slow");

					$(".accidentticket").hide("slow");

					$(".cancelticket").show("slow");
					$(".mechanicalticket").hide("slow");
				});

				$(".deletecard").click(function(){
					$(".addcarform").hide("slow");
					$(".updatecarform").hide("slow");

				});
				// Modal initialization
				$('.modal').modal();

				// Form initialization
				$('select').formSelect();

				// 	$('.addbuttondeleteform').on('click',function(){
				// 		var inputfield = $('<div class="row"><div class="col s10 m10 l10 input-field"><i class="material-icons prefix ">directions_car</i><input id="car_no" type="text" class="validate"><label for="car_no">Enter Car Number</label></div><div class="col s2 l2 m2"><a class="btn-floating btn-small waves-effect waves-light red addbuttondeleteform"><i class="material-icons ">add</i></a><a class="btn-floating btn-small waves-effect waves-light red addbuttondeleteform"><i class="material-icons addbuttondeleteform">delete</i></a></div></div>');
				// 	$(".deleteinput").append(inputfield);

				// });




			}
			);
		</script>
		<script>
console.log("here i am");
			// total users rented graph
			window.onload = function () {
				console.log("admin ki shakti");
				var carname=[];
				var caravialable=[];
				var carRented=[];
				var myJson;
var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {

	 myJson=this.response;

	 var stuff = JSON.parse(myJson);
	 Object.keys(stuff).forEach(function(key){

		 			carname.push(stuff[key]["carType"]);
					caravialable.push(stuff[key]["availableCars"]);
						carRented.push(stuff[key]["rentedCars"]);

	 });

    }

};
  xhttp.open("GET", "http://9.202.17.174:8081/admin/stats/cars", false);
  xhttp.send();

  var piedata = {
  	datasets: [{
  		data: caravialable,
		 backgroundColor: ["#0074D9", "#FF4136", "#2ECC40", "#FF851B"]
  	}],

  	// These labels appear in the legend and in the tooltips when hovering different arcs
  	labels: carname

  };

var ctx = document.getElementById('myrentedcarstatAvailablePie').getContext('2d');
  var myPieChart = new Chart(ctx, {
      type: 'pie',

      data: piedata,
	  options:{
		  title: {
            display: true,
            text: 'Available Cars'
        }
	}


      // options: options
  });

  var piedata = {
    datasets: [{
  	  data: carRented,
  	   backgroundColor: ["#0074D9", "#FF4136", "#2ECC40", "#FF851B"]
    }],

    // These labels appear in the legend and in the tooltips when hovering different arcs
    labels: carname

  };

  var ctx = document.getElementById('myrentedcarstatRentedPie').getContext('2d');
  var myPieChart = new Chart(ctx, {
  	type: 'pie',

  	data: piedata,
  	options:{
		title: {
		   display: true,
		   text: 'Rented Cars'
	   }
	}


  	// options: options
  });









				// total cars rented graph
				var ctx = document.getElementById('myrentedcarstatChart').getContext('2d');
				var chart = new Chart(ctx, {
					// The type of chart we want to create
					type: 'line',


					// The data for our dataset
					data: {
						labels:carname,
						datasets: [{
							label: 'Booking Statistics',
							// backgroundColor: 'rgb(255, 99, 132)',
							borderColor: 'rgb(122, 99, 132)',
							data: caravialable
						}]
					},

					// Configuration options go here
					options: {
						title: {
				              display: true,
				              text: 'Current Car Booked Chart'
				          },
						scales: {
		   yAxes: [{
			   ticks: {
				   beginAtZero: true
			   }
		   }]
	   }
					}
				});



				// Top Cars rented graph
				var ctx = document.getElementById('mytopcarChart').getContext('2d');
				var chart = new Chart(ctx, {
					// The type of chart we want to create
					type: 'bar',

					// The data for our dataset
					data: {
						labels: carname,
						datasets: [{
							label: 'Top Cars Rented Graph',
							// backgroundColor: 'rgb(255, 99, 132)',
							borderColor: 'rgb(222, 129, 32)',
							data: carRented,
							backgroundColor: ["#0074D9", "#FF4136", "#2ECC40", "#FF851B"]
						}],

					},

					// Configuration options go here
					options: {}
				});



			}


		</script>



	</body>
</html>
